# 自定义右键菜单功能说明

## 功能概述

为博客添加了自定义右键菜单功能，提供便捷的导航和操作选项。菜单会根据是否选中文字智能切换不同的功能选项。

## 功能特性

### 普通菜单（无选中文字时）

在页面空白处右键点击时显示：

- 🔄 **刷新页面** - 重新加载当前页面
- ⬆️ **转到顶部** - 平滑滚动到页面顶部
- ⬇️ **转到底部** - 平滑滚动到页面底部
- 🌓 **切换亮/暗色模式** - 在明亮和暗黑主题间切换
- 🏠 **回到首页** - 返回网站首页

### 选中文字菜单

选中文字后右键点击时显示：

- 🔍 **本站搜索** - 使用选中的文字在本站内搜索
- 🌐 **必应搜索** - 在必应搜索引擎中搜索选中的文字
- 📋 **复制所选内容** - 复制选中的文字到剪贴板

## 文件说明

### CSS 文件
- `source/css/context-menu.css` - 右键菜单的样式文件
  - 支持亮色/暗色主题自动切换
  - 美观的动画效果
  - 响应式设计

### JavaScript 文件
- `source/js/context-menu.js` - 右键菜单的功能实现
  - 智能菜单切换
  - 防止溢出屏幕的自动定位
  - 输入框中保留系统默认菜单

### 测试文件
- `test-context-menu.html` - 功能测试页面
  - 可以在本地测试所有功能
  - 包含使用说明和示例

## 集成方式

已自动集成到主题模板中：

1. **CSS 引入** - 在 `themes/vivia/layout/_partial/head.ejs` 中添加：
   ```ejs
   <%- css('css/context-menu') %>
   ```

2. **JavaScript 引入** - 在 `themes/vivia/layout/layout.ejs` 中添加：
   ```ejs
   <script src="<%- url_for("/js/context-menu.js") %>"></script>
   ```

## 使用说明

### 基本使用

1. **查看普通菜单**
   - 在页面任意空白处点击鼠标右键
   - 选择需要的功能项

2. **查看选中文字菜单**
   - 用鼠标选中任意文字
   - 点击鼠标右键
   - 选择搜索或复制功能

3. **关闭菜单**
   - 点击菜单外的任意位置
   - 按下 ESC 键
   - 滚动页面

### 特殊说明

- **输入框保护**：在输入框（input、textarea）中右键点击时，仍显示系统默认菜单，以保证正常的编辑功能
- **自动定位**：菜单会自动调整位置，避免超出屏幕边界
- **主题适配**：菜单样式会自动适配当前的亮色/暗色主题

## 测试方法

### 方法一：本地测试文件
1. 在浏览器中打开 `test-context-menu.html`
2. 按照页面提示测试各项功能

### 方法二：生成并预览博客
1. 运行生成命令：
   ```bash
   hexo clean && hexo generate
   ```

2. 启动本地服务器：
   ```bash
   hexo server
   ```

3. 在浏览器中访问 `http://localhost:4000`
4. 测试右键菜单功能

## 自定义配置

### 修改菜单项

编辑 `source/js/context-menu.js` 文件：

```javascript
// 修改普通菜单项
function getNormalMenuItems() {
    return [
        {
            icon: 'fas fa-your-icon',  // Font Awesome 图标
            text: '你的菜单项',
            action: () => {
                // 你的功能代码
            }
        },
        // 更多菜单项...
    ];
}

// 修改选中文字菜单项
function getSelectionMenuItems() {
    // 类似上面的配置
}
```

### 修改样式

编辑 `source/css/context-menu.css` 文件，调整：
- 菜单背景色
- 文字颜色
- 悬停效果
- 动画效果
- 菜单大小等

## 浏览器兼容性

- ✅ Chrome/Edge (最新版本)
- ✅ Firefox (最新版本)
- ✅ Safari (最新版本)
- ✅ Opera (最新版本)

## 技术实现

### 核心功能
- 使用原生 JavaScript 实现，无需额外依赖
- 监听 `contextmenu` 事件阻止默认菜单
- 动态生成菜单 DOM 元素
- CSS3 动画提升用户体验

### 性能优化
- 事件委托机制
- 防抖处理
- 内存管理（避免重复创建 DOM）

### 用户体验
- 平滑的动画过渡
- 智能的位置调整
- 键盘快捷键支持（ESC 关闭）
- Toast 提示反馈

## 注意事项

1. **Font Awesome 依赖**：需要确保页面已引入 Font Awesome 图标库
2. **本站搜索功能**：需要配合现有的搜索功能使用
3. **主题变量**：使用 CSS 变量适配主题，确保主题支持相应的变量定义

## 更新日志

### v1.0.0 (2025-10-05)
- ✨ 初始版本发布
- ✨ 实现普通菜单和选中文字菜单
- ✨ 支持亮色/暗色主题
- ✨ 添加常用导航和搜索功能

## 未来计划

- [ ] 添加更多自定义菜单项
- [ ] 支持菜单项的拖拽排序
- [ ] 添加用户偏好设置
- [ ] 支持多语言

## 反馈与建议

如有问题或建议，欢迎提出！
